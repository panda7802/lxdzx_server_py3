<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" style="height: 100%;">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>
    <script type="text/javascript" src="/static/js/jquery.js"></script>
    <title>查询</title>
    <style>
        .can_sort {
        {#background: #00F7DE;#}
        }

        .cannot_sort {
            pointer-events: none;
        }

    </style>
</head>

<body style="font-size:24pt;-webkit-user-select:none;
    -moz-user-select:none;
    -ms-user-select:none;
    user-select:none;">
<div>点击列名排序</div>
<table border="1" style="margin-left:5%;width: 90%;height: 70%;text-align: center">
    <thead>
    <tr>
        <th class="cannot_sort">序号</th>
        <th class="can_sort">上级地名</th>
        <th class="can_sort">地名</th>
        <th class="can_sort">确诊</th>
        <th class="can_sort">治愈</th>
        <th class="can_sort">死亡</th>
        <th class="can_sort">确诊率(万分之)</th>
        <th class="can_sort">治愈率(%)</th>
        <th class="can_sort">死亡率(%)</th>
    </tr>
    </thead>
    <tbody>
    {% for item in res %}
        <tr id="item_{{ forloop.counter }}" style="height:8%">
            <td id="tid">
                {{ forloop.counter }}
            </td>
            <td id="p_name_{{ forloop.counter }}" class="cannot_sort">
                {{ item.p_name }}
            </td>
            <td id="zone_name_{{ forloop.counter }}" class="cannot_sort">
                {{ item.zone_name }}
            </td>
            <td id="confirmedNum_{{ forloop.counter }}" class="sel">
                {{ item.confirmedNum }}
            </td>
            <td id="curesNum_{{ forloop.counter }}" class="sel">
                {{ item.curesNum }}
            </td>
            <td id="deathsNum_{{ forloop.counter }}" class="sel">
                {{ item.deathsNum }}
            </td>
            <td id="confirmedRate_{{ forloop.counter }}" class="sel">
                {{ item.confirmedRate }}
            </td>
            <td id="curesRate_{{ forloop.counter }}" class="sel">
                {{ item.curesRate }}
            </td>
            <td id="deathsRate_{{ forloop.counter }}" class="sel">
                {{ item.deathsRate }}
            </td>
        </tr>
    {% endfor %}
    </tbody>
</table>
</body>
<script>
    $(document).ready(function () {
            var sort_direction = 1; //排序标志，1为升序，-1为降序
            $('th').each(function (i) {
                    $(this).click(function () {
                            if (sort_direction === 1) {
                                sort_direction = -1;
                            } else {
                                sort_direction = 1;
                            }
                            //获得行数组
                            var trarr = $('table').find('tbody > tr').get();
                            //数组排序
                            trarr.sort(function (a, b) {
                                    var col1 = Number($(a).children('td').eq(i).text().toUpperCase());
                                    var col2 = Number($(b).children('td').eq(i).text().toUpperCase());
                                    return (col1 < col2) ? -sort_direction : (col1 > col2) ? sort_direction : 0;
                                    //返回-1表示a>b降序,返回1表示a<b升序,否则为0相等
                                }
                            );
                            $.each(trarr, function (i, row) {
                                    //将排好序的数组重新填回表格
                                    {#console.log(i);#}
                                    {#console.log(typeof row);#}
                                    {#    console.log(trarr[i]);#}
                                    {#    row.children("tr").each(function (j) {#}
                                    {#        console.log( $(this).text());#}
                                    {#    });#}
                                    {#console.log("第" + i + "个td的内容：" + $(this).text());#}
                                    {#console.log( trarr[i].find("tr").val());#}
                                    $('tbody').append(row);
                                }
                            );
                            $('tbody > tr').each(function (i) {                   // 遍历 tr
                                $(this).children('td')[0].innerText = (i + 1) + "";
                            });
                        }
                    );
                }
            );
        }
    )
    ;
</script>
</html>
